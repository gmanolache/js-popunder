(function(d){var h=function(a,b){this.__construct(a,b)},n=0,l=0,p=top!=self?top:self,f=navigator.userAgent.toLowerCase(),q=/webkit/.test(f);/mozilla/.test(f)&&/(compatible|webkit)/.test(f);var k=/chrome/.test(f),r=/msie|trident\//.test(f)&&!/opera/.test(f),t=/firefox/.test(f);/safari/.test(f)&&/chrome/.test(f);/opera/.test(f);var m=parseInt(f.match(/(?:[^\s]+(?:ri|ox|me|ra)\/|trident\/.*?rv:)([\d]+)/i)[1],10),g={simulateClick:function(a){var b=document.createElement("a"),c=document.createEvent("MouseEvents"); b.href=a||"data:text/html,<script>window.close();\x3c/script>;";document.body.appendChild(b);c.initMouseEvent("click",!0,!0,d,0,0,0,0,0,!0,!1,!1,!0,0,null);b.dispatchEvent(c);b.parentNode.removeChild(b)},blur:function(a){try{a.blur(),a.opener.window.focus(),d.self.window.focus(),d.focus(),t?this.openCloseWindow(a):q?(!k||k&&41>m)&&this.openCloseTab():r&&setTimeout(function(){a.blur();a.opener.window.focus();d.self.window.focus();d.focus()},1E3)}catch(b){}},createElement:function(a,b){var c=document.createElement(a), d;for(d in b)c.setAttribute(d,b[d]);return c},openCloseWindow:function(a){var b=a.window.open("about:blank");b.focus();b.close();setTimeout(function(){try{b=a.window.open("about:blank"),b.focus(),b.close()}catch(c){}},1)},openCloseTab:function(){this.simulateClick()},isFlashInstalled:function(){return!!navigator.mimeTypes["application/x-shockwave-flash"]},initFlashPopunder:function(a){if(this.isFlashInstalled){var b=this,c=a.name,d,e=this.createElement("object",{type:"application/x-shockwave-flash", data:h.flashUrl,name:c,id:c,style:"position:fixed;visibility:visible;left:0;top:0;width:1px;height:1px;z-index:9999999;"});e.appendChild(this.createElement("param",{name:"flashvars",value:"fire="+a.name+".fire&name="+a.name}));e.appendChild(this.createElement("param",{name:"wmode",value:"transparent"}));e.appendChild(this.createElement("param",{name:"menu",value:"false"}));e.appendChild(this.createElement("param",{name:"allowscriptaccess",value:"always"}));d=setInterval(function(){"complete"==document.readyState&& (clearInterval(d),document.body.insertBefore(e,document.body.firstChild),e.focus(),b.attachEvent("mousedown",function(a){0===a.button&&(document.getElementById(c).style.width=document.getElementById(c).style.height="100%")}))},10);return e}},detachEvent:function(a,b,c){c=c||d;return c.removeEventListener?c.removeEventListener(a,b):c.detachEvent("on"+a,b)},attachEvent:function(a,b,c){c=c||d;return c.addEventListener?c.addEventListener(a,b):c.attachEvent("on"+a,b)},mergeObject:function(){var a={},b, c;for(b=0;b<arguments.length;b++)for(c in arguments[b])a[c]=arguments[b][c];return a},getCookie:function(a){return(a=document.cookie.match(new RegExp(a+"=[^;]+","i")))?decodeURIComponent(a[0].split("=")[1]):null},setCookie:function(a,b,c,d){if(null===c||"undefined"==typeof c)c="";else{var e;"number"==typeof c?(e=new Date,e.setTime(e.getTime()+6E4*c)):e=c;c="; expires="+e.toUTCString()}document.cookie=a+"="+escape(b)+c+"; path="+(d||"/")}};h.flashUrl="flash/flash.swf";h.prototype={defaultWindowOptions:{width:d.screen.width, height:d.screen.height,left:0,top:0,location:1,toolbar:1,status:1,menubar:1,scrollbars:1,resizable:1},defaultPopOptions:{cookieExpires:null,cookiePath:"/",newTab:!0,blur:!0,chromeDelay:500,smart:!1,beforeOpen:function(){},afterOpen:function(){}},__newWindowOptionsFlash:{menubar:0,toolbar:0},__newWindowOptionsChromeBefore41:{scrollbars:1},__construct:function(a,b){this.url=a;this.index=n++;this.name="SmartPopunder_"+this.index;this.executed=!1;this.setOptions(b);this.register();d[this.name]=this}, register:function(){if(!this.isExecuted()){this.options.blur&&!this.options.newTab&&g.initFlashPopunder(this);var a=this,b=function(){a.shouldExecute()&&(a.fire(),g.detachEvent("click",b,d),g.detachEvent("click",b,document))};g.attachEvent("click",b,d);g.attachEvent("click",b,document)}},fire:function(a){a=d[a]||this;var b;a.options.beforeOpen.call(void 0,this);l=(new Date).getTime();a.setExecuted();a.options.newTab?k&&30<m&&a.options.blur?(d.open("javascript:window.focus()","_self",""),g.simulateClick(a.url), b=null):b=p.window.open(a.url,"_blank"):b=d.open(a.url,a.url,a.getParams());a.options.afterOpen.call(void 0,this);a.options.blur&&g.blur(b)},shouldExecute:function(){return k&&l&&l+this.options.chromeDelay>(new Date).getTime()?!1:!this.isExecuted()},isExecuted:function(){return this.executed||!!g.getCookie(this.name)},setExecuted:function(){this.executed=!0;g.setCookie(this.name,1,this.options.cookieExpires,this.options.cookiePath)},setOptions:function(a){this.options=g.mergeObject(this.defaultWindowOptions, this.defaultPopOptions,a||{});if(!this.options.newTab){if(k&&41>m)for(var b in this.__newWindowOptionsChromeBefore41)this.options[b]=this.__newWindowOptionsChromeBefore41[b];if(g.isFlashInstalled())for(b in this.__newWindowOptionsFlash)this.options[b]=this.__newWindowOptionsFlash[b]}},getParams:function(){var a="",b;for(b in this.options)"undefined"!=typeof this.defaultWindowOptions[b]&&(a+=(a?",":"")+b+"="+this.options[b]);return a}};h.make=function(a,b){return new this(a,b)};d.SmartPopunder=h})(this);
